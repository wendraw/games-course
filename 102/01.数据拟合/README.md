> PPT: [01.æ•°æ®æ‹Ÿåˆ.pptx](http://staff.ustc.edu.cn/~lgliu/Courses/GAMES102_2020/PPT/GAMES102-1_DataFitting.pdf)
> è§†é¢‘: [01.æ•°æ®æ‹Ÿåˆ.mp4](https://www.bilibili.com/video/BV1NA411E7Yr/?share_source=copy_web&vd_source=43929e1eb72edc92ccec94f51d8e77e7)

## æ¦‚è¿°

æ•°æ®æ‹Ÿåˆæ˜¯è®¡ç®—æœºå›¾å½¢å­¦å’Œæ•°å€¼åˆ†æä¸­çš„åŸºç¡€é—®é¢˜ï¼Œç›®æ ‡æ˜¯æ ¹æ®ç»™å®šçš„æ•°æ®ç‚¹æ‰¾åˆ°ä¸€ä¸ªå‡½æ•°æ¥æè¿°æˆ–è¿‘ä¼¼è¿™äº›æ•°æ®ã€‚æœ¬é¡¹ç›®å®ç°äº†ä¸¤ç§ç»å…¸çš„æ‹Ÿåˆæ–¹æ³•ï¼š

1. **æ’å€¼å‹æ‹Ÿåˆ**ï¼šè¦æ±‚æ‹Ÿåˆå‡½æ•°å¿…é¡»é€šè¿‡æ‰€æœ‰ç»™å®šçš„æ•°æ®ç‚¹
2. **é€¼è¿‘å‹æ‹Ÿåˆ**ï¼šå…è®¸æ‹Ÿåˆå‡½æ•°ä¸å®Œå…¨é€šè¿‡æ•°æ®ç‚¹ï¼Œè€Œæ˜¯å¯»æ‰¾æœ€ä½³çš„æ•´ä½“æ‹Ÿåˆæ•ˆæœ

---

## 1. æ’å€¼å‹æ‹Ÿåˆ - æ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•

### åŸºæœ¬åŸç†

æ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•æ˜¯ä¸€ç§ç»å…¸çš„å¤šé¡¹å¼æ’å€¼æ–¹æ³•ï¼Œå…¶åŸºæœ¬æ€æƒ³æ˜¯ï¼šç»™å®š n+1 ä¸ªä¸åŒçš„æ•°æ®ç‚¹ $(x_0, y_0), (x_1, y_1), ..., (x_n, y_n)$ï¼Œæ„é€ ä¸€ä¸ª n æ¬¡å¤šé¡¹å¼ $P(x)$ï¼Œä½¿å¾— $P(x_i) = y_i$ å¯¹æ‰€æœ‰ $i = 0, 1, ..., n$ æˆç«‹ã€‚

### æ•°å­¦å…¬å¼

æ‹‰æ ¼æœ—æ—¥æ’å€¼å¤šé¡¹å¼çš„è¡¨è¾¾å¼ä¸ºï¼š

$$P(x) = \sum_{i=0}^{n} y_i \cdot L_i(x)$$

å…¶ä¸­ $L_i(x)$ æ˜¯æ‹‰æ ¼æœ—æ—¥åŸºå‡½æ•°ï¼š

$$L_i(x) = \prod_{j=0, j \neq i}^{n} \frac{x - x_j}{x_i - x_j}$$

### ç®—æ³•æ­¥éª¤

1. **è¾“å…¥**ï¼šn+1 ä¸ªæ•°æ®ç‚¹ $(x_i, y_i)$
2. **å¯¹äºæ¯ä¸ªæ’å€¼ç‚¹ x**ï¼š
   - è®¡ç®—æ¯ä¸ªæ‹‰æ ¼æœ—æ—¥åŸºå‡½æ•° $L_i(x)$
   - è®¡ç®—åŠ æƒå’Œ $P(x) = \sum_{i=0}^{n} y_i \cdot L_i(x)$
3. **è¾“å‡º**ï¼šæ’å€¼å¤šé¡¹å¼åœ¨ç‚¹ x å¤„çš„å€¼

### ä»£ç å®ç°è§£æ

```javascript
interpolation: (points, x) => {
  if (points.length === 0) return 0
  if (points.length === 1) return points[0].y

  let result = 0
  for (let i = 0; i < points.length; i++) {
    let term = points[i].y // y_i
    for (let j = 0; j < points.length; j++) {
      if (i !== j) {
        const denominator = points[i].x - points[j].x
        if (Math.abs(denominator) < 1e-10) {
          return points[i].y // é¿å…é™¤é›¶é”™è¯¯
        }
        term *= (x - points[j].x) / denominator // æ„é€  L_i(x)
      }
    }
    result += term
  }
  return result
}
```

### ç‰¹ç‚¹ä¸åº”ç”¨

**ä¼˜ç‚¹**ï¼š

- ç²¾ç¡®é€šè¿‡æ‰€æœ‰æ•°æ®ç‚¹
- æ•°å­¦å½¢å¼ç®€æ´ä¼˜ç¾
- é€‚ç”¨äºç²¾ç¡®æ’å€¼éœ€æ±‚

**ç¼ºç‚¹**ï¼š

- éšç€æ•°æ®ç‚¹å¢å¤šï¼Œå¤šé¡¹å¼æ¬¡æ•°å¢é«˜ï¼Œå¯èƒ½å‡ºç°é¾™æ ¼ç°è±¡ï¼ˆæŒ¯è¡ï¼‰
- å¯¹æ•°æ®ä¸­çš„å™ªå£°æ•æ„Ÿ
- è®¡ç®—å¤æ‚åº¦è¾ƒé«˜ï¼šO(nÂ²)

**é€‚ç”¨åœºæ™¯**ï¼š

- æ•°æ®ç‚¹è¾ƒå°‘ï¼ˆé€šå¸¸<10 ä¸ªï¼‰
- æ•°æ®ç²¾åº¦è¦æ±‚é«˜
- éœ€è¦å¹³æ»‘è¿ç»­çš„æ›²çº¿

---

## 2. é€¼è¿‘å‹æ‹Ÿåˆ - æœ€å°äºŒä¹˜æ³•

### åŸºæœ¬åŸç†

æœ€å°äºŒä¹˜æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯å¯»æ‰¾ä¸€ä¸ªå‡½æ•°ï¼ˆé€šå¸¸æ˜¯å¤šé¡¹å¼ï¼‰ï¼Œä½¿å¾—è¯¥å‡½æ•°ä¸æ‰€æœ‰æ•°æ®ç‚¹çš„è¯¯å·®å¹³æ–¹å’Œæœ€å°ã€‚å¯¹äºäºŒæ¬¡å¤šé¡¹å¼æ‹Ÿåˆï¼Œæˆ‘ä»¬è¦æ‰¾åˆ°ç³»æ•° $a, b, c$ ä½¿å¾—ï¼š

$$f(x) = ax^2 + bx + c$$

æœ€å°åŒ–ç›®æ ‡å‡½æ•°ï¼š

$$S = \sum_{i=0}^{n} (y_i - f(x_i))^2 = \sum_{i=0}^{n} (y_i - ax_i^2 - bx_i - c)^2$$

### æ•°å­¦æ¨å¯¼

ä¸ºäº†æœ€å°åŒ– $S$ï¼Œæˆ‘ä»¬å¯¹ $a, b, c$ æ±‚åå¯¼æ•°å¹¶ä»¤å…¶ä¸ºé›¶ï¼š

$$\frac{\partial S}{\partial a} = -2\sum_{i=0}^{n} x_i^2(y_i - ax_i^2 - bx_i - c) = 0$$

$$\frac{\partial S}{\partial b} = -2\sum_{i=0}^{n} x_i(y_i - ax_i^2 - bx_i - c) = 0$$

$$\frac{\partial S}{\partial c} = -2\sum_{i=0}^{n} (y_i - ax_i^2 - bx_i - c) = 0$$

æ•´ç†åå¾—åˆ°æ­£è§„æ–¹ç¨‹ç»„ï¼š

$$
\begin{cases}
c \cdot n + b \cdot \sum x_i + a \cdot \sum x_i^2 = \sum y_i \\
c \cdot \sum x_i + b \cdot \sum x_i^2 + a \cdot \sum x_i^3 = \sum x_i y_i \\
c \cdot \sum x_i^2 + b \cdot \sum x_i^3 + a \cdot \sum x_i^4 = \sum x_i^2 y_i
\end{cases}
$$

### çŸ©é˜µå½¢å¼

å†™æˆçŸ©é˜µå½¢å¼ï¼š

$$
\begin{bmatrix}
n & \sum x_i & \sum x_i^2 \\
\sum x_i & \sum x_i^2 & \sum x_i^3 \\
\sum x_i^2 & \sum x_i^3 & \sum x_i^4
\end{bmatrix}
\begin{bmatrix}
c \\ b \\ a
\end{bmatrix}
=
\begin{bmatrix}
\sum y_i \\
\sum x_i y_i \\
\sum x_i^2 y_i
\end{bmatrix}
$$

### é«˜æ–¯æ¶ˆå…ƒæ³•æ±‚è§£

ä½¿ç”¨é«˜æ–¯æ¶ˆå…ƒæ³•æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„ï¼š

1. **å‰å‘æ¶ˆå…ƒ**ï¼šå°†çŸ©é˜µåŒ–ä¸ºä¸Šä¸‰è§’çŸ©é˜µ
2. **å›ä»£æ±‚è§£**ï¼šä»æœ€åä¸€è¡Œå¼€å§‹é€æ­¥æ±‚è§£

### ä»£ç å®ç°è§£æ

```javascript
approximation: (points, x) => {
  // å¤„ç†è¾¹ç•Œæƒ…å†µ
  if (points.length === 0) return 0
  if (points.length === 1) return points[0].y
  if (points.length === 2) {
    // ä¸¤ç‚¹æ—¶ä½¿ç”¨çº¿æ€§æ‹Ÿåˆ
    const [p1, p2] = points
    const slope = (p2.y - p1.y) / (p2.x - p1.x)
    return p1.y + slope * (x - p1.x)
  }

  // è®¡ç®—å„é¡¹å’Œ
  const n = points.length
  let sumX = 0,
    sumY = 0,
    sumX2 = 0,
    sumX3 = 0,
    sumX4 = 0
  let sumXY = 0,
    sumX2Y = 0

  for (let i = 0; i < n; i++) {
    const xi = points[i].x
    const yi = points[i].y
    sumX += xi
    sumY += yi
    sumX2 += xi * xi
    sumX3 += xi * xi * xi
    sumX4 += xi * xi * xi * xi
    sumXY += xi * yi
    sumX2Y += xi * xi * yi
  }

  // æ„é€ ç³»æ•°çŸ©é˜µ
  const matrix = [
    [n, sumX, sumX2, sumY],
    [sumX, sumX2, sumX3, sumXY],
    [sumX2, sumX3, sumX4, sumX2Y],
  ]

  // æ±‚è§£å¹¶è¿”å›ç»“æœ
  const coeffs = gaussElimination(matrix)
  const a = coeffs[2],
    b = coeffs[1],
    c = coeffs[0]
  return a * x * x + b * x + c
}
```

### ç‰¹ç‚¹ä¸åº”ç”¨

**ä¼˜ç‚¹**ï¼š

- å¯¹å™ªå£°æ•°æ®æœ‰è¾ƒå¼ºçš„é²æ£’æ€§
- å¯ä»¥æ§åˆ¶æ‹Ÿåˆå‡½æ•°çš„å¤æ‚åº¦
- æ•´ä½“æ‹Ÿåˆæ•ˆæœè‰¯å¥½
- è®¡ç®—ç¨³å®š

**ç¼ºç‚¹**ï¼š

- ä¸ä¸€å®šé€šè¿‡æ‰€æœ‰æ•°æ®ç‚¹
- éœ€è¦é¢„å…ˆé€‰æ‹©æ‹Ÿåˆå‡½æ•°çš„å½¢å¼
- å¯èƒ½å‡ºç°è¿‡æ‹Ÿåˆæˆ–æ¬ æ‹Ÿåˆ

**é€‚ç”¨åœºæ™¯**ï¼š

- æ•°æ®åŒ…å«å™ªå£°
- æ•°æ®ç‚¹è¾ƒå¤š
- éœ€è¦å¹³æ»‘çš„è¶‹åŠ¿çº¿
- é¢„æµ‹å’Œå¤–æ¨

---

## 3. ä¸¤ç§æ–¹æ³•çš„æ¯”è¾ƒ

### è§†è§‰å¯¹æ¯”

åœ¨æˆ‘ä»¬çš„æ¼”ç¤ºåº”ç”¨ä¸­ï¼š

- ğŸ”µ **è“è‰²æ›²çº¿**ï¼šæ’å€¼å‹æ‹Ÿåˆ - ç²¾ç¡®é€šè¿‡æ‰€æœ‰çº¢ç‚¹
- ğŸŸ¢ **ç»¿è‰²æ›²çº¿**ï¼šé€¼è¿‘å‹æ‹Ÿåˆ - æ•´ä½“è¶‹åŠ¿æ‹Ÿåˆï¼Œä¸ä¸€å®šé€šè¿‡æ‰€æœ‰ç‚¹

### æ•°å­¦ç‰¹æ€§å¯¹æ¯”

| ç‰¹æ€§       | æ’å€¼å‹æ‹Ÿåˆ       | é€¼è¿‘å‹æ‹Ÿåˆ                 |
| ---------- | ---------------- | -------------------------- |
| ç²¾åº¦       | ç²¾ç¡®é€šè¿‡æ‰€æœ‰ç‚¹   | æ•´ä½“æœ€ä¼˜ï¼Œä¸ä¸€å®šé€šè¿‡æ‰€æœ‰ç‚¹ |
| ç¨³å®šæ€§     | å¯¹å™ªå£°æ•æ„Ÿ       | å¯¹å™ªå£°é²æ£’                 |
| å¤šé¡¹å¼æ¬¡æ•° | n-1 æ¬¡ï¼ˆn ä¸ªç‚¹ï¼‰ | å¯æ§åˆ¶ï¼ˆé€šå¸¸ä½æ¬¡ï¼‰         |
| è®¡ç®—å¤æ‚åº¦ | O(nÂ²)            | O(n)                       |
| é€‚ç”¨æ•°æ®é‡ | å°æ•°æ®é›†         | å¤§æ•°æ®é›†                   |

### é€‰æ‹©å»ºè®®

**é€‰æ‹©æ’å€¼å‹æ‹Ÿåˆå½“**ï¼š

- æ•°æ®ç‚¹å°‘ä¸”ç²¾ç¡®
- éœ€è¦ç²¾ç¡®é€šè¿‡æ‰€æœ‰ç‚¹
- æ•°æ®æ— å™ªå£°
- ç”¨äºç²¾ç¡®æ’å€¼è®¡ç®—

**é€‰æ‹©é€¼è¿‘å‹æ‹Ÿåˆå½“**ï¼š

- æ•°æ®ç‚¹å¤š
- æ•°æ®åŒ…å«å™ªå£°
- éœ€è¦å¹³æ»‘è¶‹åŠ¿
- ç”¨äºé¢„æµ‹å’Œåˆ†æ

---

## 4. å®é™…åº”ç”¨ç¤ºä¾‹

### åœ¨è®¡ç®—æœºå›¾å½¢å­¦ä¸­çš„åº”ç”¨

1. **æ›²çº¿è®¾è®¡**ï¼š

   - æ’å€¼ï¼šç²¾ç¡®æ§åˆ¶å…³é”®ç‚¹ä½ç½®
   - é€¼è¿‘ï¼šå¹³æ»‘çš„æ›²çº¿å¤–è§‚

2. **åŠ¨ç”»æ’å€¼**ï¼š

   - å…³é”®å¸§ä¹‹é—´çš„å¹³æ»‘è¿‡æ¸¡
   - è·¯å¾„è§„åˆ’

3. **æ•°æ®å¯è§†åŒ–**ï¼š
   - æ•£ç‚¹å›¾çš„è¶‹åŠ¿çº¿
   - æ•°æ®å¹³æ»‘å¤„ç†

### æ•°å€¼åˆ†æä¸­çš„åº”ç”¨

1. **å‡½æ•°é€¼è¿‘**ï¼š

   - å¤æ‚å‡½æ•°çš„å¤šé¡¹å¼è¿‘ä¼¼
   - æ•°å€¼ç§¯åˆ†

2. **æ•°æ®åˆ†æ**ï¼š
   - å®éªŒæ•°æ®çš„æ‹Ÿåˆ
   - è¶‹åŠ¿é¢„æµ‹

---

## 5. æ‰©å±•æ€è€ƒ

### é«˜çº§æ‹Ÿåˆæ–¹æ³•

1. **æ ·æ¡æ’å€¼**ï¼šåˆ†æ®µå¤šé¡¹å¼ï¼Œé¿å…é«˜æ¬¡å¤šé¡¹å¼çš„æŒ¯è¡
2. **åŠ æƒæœ€å°äºŒä¹˜**ï¼šå¯¹ä¸åŒæ•°æ®ç‚¹èµ‹äºˆä¸åŒæƒé‡
3. **æ­£åˆ™åŒ–æ–¹æ³•**ï¼šé˜²æ­¢è¿‡æ‹Ÿåˆ
4. **éçº¿æ€§æ‹Ÿåˆ**ï¼šæ‹Ÿåˆå¤æ‚çš„éçº¿æ€§å‡½æ•°

### æ•°å€¼ç¨³å®šæ€§

1. **æ¡ä»¶æ•°**ï¼šçŸ©é˜µæ±‚è§£çš„æ•°å€¼ç¨³å®šæ€§
2. **ç²¾åº¦æ§åˆ¶**ï¼šæµ®ç‚¹æ•°è®¡ç®—çš„è¯¯å·®æ§åˆ¶
3. **ç®—æ³•ä¼˜åŒ–**ï¼šæ›´é«˜æ•ˆçš„æ±‚è§£ç®—æ³•

é€šè¿‡æœ¬é¡¹ç›®çš„å®ç°ï¼Œæ‚¨å¯ä»¥ç›´è§‚åœ°ç†è§£è¿™ä¸¤ç§åŸºç¡€ä½†é‡è¦çš„æ‹Ÿåˆæ–¹æ³•ï¼Œä¸ºè¿›ä¸€æ­¥å­¦ä¹ æ›´é«˜çº§çš„æ•°å€¼æ–¹æ³•æ‰“ä¸‹åŸºç¡€ã€‚
